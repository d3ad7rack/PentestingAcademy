#!/bin/bash

clear
echo
echo Crawl
echo
echo
echo By Lee Baird
echo March 23, 2007
echo "v 0.2"
echo
echo "This script will return a list of IP addresses to web servers that are linked from a given domain's home page."
echo
echo Usage:  domain.com
echo Enter the domain you wish to crawl.
echo
read domain
echo
echo "####################"
echo
wget www.$domain

grep "href=" index.html | cut -d "/" -f3 | grep $domain | cut -d '"' -f1 | sort -u > $domain-servers.txt

for x in $(cat $domain-servers.txt);do
host $x | grep "has address" | cut -d " " -f4 >> $domain-ips.txt
done
cat $domain-ips.txt | sort -u > $domain.txt

rm index.html
rm $domain-servers.txt
rm $domain-ips.txt

echo "####################"
echo
cat $domain.txt
echo
echo The following file has been created:  $domain.txt
echo
clear
echo
echo Recon
echo
echo
echo By Lee Baird
echo March 26, 2009
echo "v 0.11"
echo
echo "This script will perform various reconnaissance on your target."
echo
echo Usage:  domain.com
echo Enter the domain.
echo
read domain
echo
echo "###########################################################################################"
echo
echo "whois" $domain
whois $domain
echo "###########################################################################################"
echo
echo "dig" $domain "any"
dig $domain any
echo "###########################################################################################"
echo
echo "host -l" $domain
echo
host -l $domain
echo
echo "###########################################################################################"
echo
echo "tcptraceroute -i eth0" $domain
echo
tcptraceroute -i eth0 $domain
echo
echo "###########################################################################################"
echo
echo "cd /pentest/enumeration/dnsenum"
echo "perl dnsenum.pl --enum -f dns.txt --update a -r" $domain
echo
cd /pentest/enumeration/dnsenum
perl dnsenum.pl --enum -f dns.txt --update a -r $domain
echo
echo "###########################################################################################"
echo
echo dnstracer $domain
echo
dnstracer $domain
echo
echo "###########################################################################################"
echo
echo "cd /pentest/enumeration/fierce"
echo "perl fierce.pl -dns" $domain
echo
cd /pentest/enumeration/fierce
perl fierce.pl -dns $domain
echo
echo "###########################################################################################"
echo
echo "cd /pentest/enumeration/lbd"
echo "./lbd.sh" $domain
cd /pentest/enumeration/lbd
./lbd.sh $domain
echo "###########################################################################################"
echo
echo "cd /pentest/enumeration/list-urls"
echo "./list-urls.py http://www."$domain
cd /pentest/enumeration/list-urls
./list-urls.py http://www.$domain
echo
echo "###########################################################################################"
echo
echo "nmap -PN -n -F -T4 -sV -A -oG temp.txt" $domain
cd /root
nmap -PN -n -F -T4 -sV -A -oG temp.txt $domain
echo
echo "###########################################################################################"
echo
echo "amap -i temp.txt"
amap -i temp.txt
echo
echo "###########################################################################################"
echo
echo "cd /pentest/enumeration/www/httprint/linux"
echo "./httprint -h www."$domain "-s signatures.txt -P0"
echo
cd /pentest/enumeration/www/httprint/linux
./httprint -h www.$domain -s signatures.txt -P0
echo
echo "###########################################################################################"
clear
echo
echo Discover
echo
echo
echo By Lee Baird
echo July 26, 2008
echo "v 0.24"
echo
echo "This script combines network discovery using propecia and scanning with nmap."
echo
echo Usage:  192.168.1
echo Enter the Class C range.
echo
read class
echo
echo "####################"
echo
echo "Looking for targets."
echo

# Make sure propecia is located in the path.
# cp /pentest/scanners/propecia/propecia /usr/bin

# TCP ports
propecia $class 21 > a.txt              # FTP
propecia $class 22 >> a.txt             # SSH
propecia $class 23 >> a.txt		# Telnet
propecia $class 25 >> a.txt		# SMTP
propecia $class 80 >> a.txt		# HTTP
propecia $class 135 >> a.txt		# RPC
propecia $class 139 >> a.txt		# NetBIOS-Session Service
propecia $class 443 >> a.txt		# SSL
propecia $class 445 >> a.txt		# SMB
propecia $class 3389 >> a.txt	        # RDP

# UDP ports
propecia $class 53 >> a.txt		# DNS
propecia $class 67 >> a.txt		# DHCP
propecia $class 123 >> a.txt		# NTP
propecia $class 137 >> a.txt		# NetBIOS-Name Service
propecia $class 161 >> a.txt		# SNMP
propecia $class 1434 >> a.txt	        # SQL

# Misc vendor ports here
propecia $class 1521 >> a.txt	        # Oracle
propecia $class 3306 >> a.txt	        # MySQL
propecia $class 5900 >> a.txt	        # VNC
propecia $class 8080 >> a.txt	        # alt HTTP
propecia $class 9100 >> a.txt	        # HP printers

# Check for zero targets
if [ `ls -l a.txt | awk '{print $5}'` -eq 0 ] ; then
	echo "No targets found."
	echo
	rm a.txt
	exit
else

# Sort IP address list
sort -u -t. -k1,1n -k2,2n -k3,3n -k4,4n a.txt >> list.txt

# Total number of targets
wc -l list.txt | cut -d " " -f1

echo
echo "####################"
echo
echo "Scanning targets."

# Start nmap scan
nmap -iL list.txt -PN -n -F -T4 --open -A > temp.txt

# Clean up nmap results
cat temp.txt | egrep -v "Not" | egrep -v "SF" | egrep -v "All" | egrep -v "unrecognized" | egrep -v "Please" | egrep -v "Nmap done" > scan.txt

# Remove temp files
rm a.txt
rm temp.txt

echo
echo "####################"
echo
cat scan.txt

fi
